{{ define "main" }}
  <header class="section-head">
    <h1 class="section-title">{{ .Title }}</h1>
    {{ with .Content }}
      <div class="section-intro">
        {{ . }}
      </div>
    {{ end }}
  </header>

  {{- $pages := sort .RegularPages "Date" "desc" -}}
  {{- $showDrafts := or hugo.IsDevelopment .Site.BuildDrafts -}}
  {{- if not $showDrafts }}
    {{- $pages = where $pages "Draft" false -}}
  {{- end -}}

  {{- $scratch := newScratch -}}
  {{- $scratch.Set "list" $pages -}}
  {{- if not $showDrafts -}}
    {{- $scratch.Set "paginator" (.Paginate $pages) -}}
    {{- $scratch.Set "list" (($scratch.Get "paginator").Pages) -}}
  {{- end -}}

  {{- $list := $scratch.Get "list" -}}
  {{- $paginator := $scratch.Get "paginator" -}}

  {{ if gt (len $list) 0 }}
    <div class="post-grid">
      {{ range $list }}
        {{ partial "post/card.html" (dict "page" .) }}
      {{ end }}
    </div>

    {{ if and (not $showDrafts) (gt $paginator.TotalPages 1) }}
      <nav class="post-pagination" aria-label="Pagination">
        {{ template "_internal/pagination.html" $paginator }}
      </nav>
    {{ end }}
  {{ else }}
    <p class="post-empty">No posts available yet. Check back soon!</p>
  {{ end }}
{{ end }}
