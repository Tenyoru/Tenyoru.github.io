{{ define "main" }}
  <header class="section-head">
    <div class="section-title-row">
      <h1 class="section-title">{{ .Title }}</h1>
      {{- if and .IsSection (eq .Section "blog") -}}
        {{- with .OutputFormats.Get "RSS" -}}
          <a class="section-rss" href="{{ .RelPermalink }}" rel="alternate" aria-label="Subscribe to the blog RSS feed" title="RSS feed for {{ $.Title }}">
            {{ partial "svg.html" "rss" }}
          </a>
        {{- end -}}
      {{- end -}}
    </div>
    {{ with .Content }}
      <div class="section-intro">
        {{ . }}
      </div>
    {{ end }}
  </header>

  {{- $pages := sort .RegularPages "Date" "desc" -}}
  {{- $showDrafts := or hugo.IsDevelopment .Site.BuildDrafts -}}

  {{- if $showDrafts -}}
    {{ if gt (len $pages) 0 }}
    <div class="post-grid">
      {{ range $pages }}
        {{ partial "post/card.html" (dict "page" .) }}
      {{ end }}
    </div>

    {{ else }}
      <p class="post-empty">No posts available yet. Check back soon!</p>
    {{ end }}
  {{- else -}}
    {{- $published := where $pages "Draft" false -}}
    {{- if gt (len $published) 0 -}}
      {{- $paginator := .Paginate $published -}}
      <div class="post-grid">
        {{ range $paginator.Pages }}
          {{ partial "post/card.html" (dict "page" .) }}
        {{ end }}
      </div>

      {{ if gt $paginator.TotalPages 1 }}
        <nav class="post-pagination" aria-label="Pagination">
          {{ template "_internal/pagination.html" $paginator }}
        </nav>
      {{ end }}
    {{- else -}}
      <p class="post-empty">No posts available yet. Check back soon!</p>
    {{- end -}}
  {{- end -}}
{{ end }}
